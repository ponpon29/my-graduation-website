<header style="position: fixed; top: 0; left: 0; right: 0; z-index: 1000;">
  <nav class='navbar navbar-expand-lg navbar-light' style="padding: 1rem; background-color: #F5F0E8;">
    <div class="container-fluid">
      <%= link_to root_path, class: 'navbar-brand' do %>
        <span class="fs-3 fw-bold text-danger">🍜 <%= t('.title') %></span>
      <% end %>
      
      <div class="d-flex">
        <% if logged_in? %>
          <div class="position-relative">
            <button class="btn btn-outline-primary" 
                    type="button" 
                    id="ramenUserBtn"
                    onclick="toggleRamenMenu()">
              <%= current_user.email if current_user %> ▼
            </button>
            <div id="ramenUserMenu" 
                 class="dropdown-menu position-absolute" 
                 style="display: none; top: 100%; right: 0; z-index: 1050;">
              <%= link_to t('.profile'), user_path(current_user), class: 'dropdown-item' %>
              <%= link_to t('.search'), maps_path, class: 'dropdown-item' %>
              <%= link_to t('.post'), boards_path, class: 'dropdown-item' %>
              <hr class="dropdown-divider">
              <%= link_to t('.logout'), logout_path, class: 'dropdown-item', data: { turbo_method: :delete } %>
            </div>
          </div>
        <% else %>
          <%= link_to t('.login'), login_path, class: "btn btn-outline-primary me-2" %>
          <%= link_to t('.create'), new_user_path, class: "btn btn-primary" %>
        <% end %>
      </div>
    </div>
  </nav>
</header>

<script>
// ========================================
// 🍜 ラーメン道専用ドロップダウン
// ========================================
function toggleRamenMenu() {
  console.log('🍜 ラーメンメニューをトグル中...');
  
  const menu = document.getElementById('ramenUserMenu');
  const btn = document.getElementById('ramenUserBtn');
  
  if (!menu || !btn) {
    console.error('❌ メニューまたはボタンが見つかりません');
    return;
  }
  
  if (menu.style.display === 'none' || menu.style.display === '') {
    // メニューを表示
    menu.style.display = 'block';
    btn.innerHTML = btn.innerHTML.replace('▼', '▲');
    console.log('✅ メニューを表示しました');
  } else {
    // メニューを非表示
    menu.style.display = 'none';
    btn.innerHTML = btn.innerHTML.replace('▲', '▼');
    console.log('✅ メニューを非表示にしました');
  }
}

// 外部クリックでメニューを閉じる
document.addEventListener('click', function(event) {
  const menu = document.getElementById('ramenUserMenu');
  const btn = document.getElementById('ramenUserBtn');
  
  if (menu && btn) {
    if (!btn.contains(event.target) && !menu.contains(event.target)) {
      menu.style.display = 'none';
      btn.innerHTML = btn.innerHTML.replace('▲', '▼');
    }
  }
});

// Turbo対応
document.addEventListener('turbo:load', function() {
  console.log('🍜 ラーメンメニュー準備完了！');
});

console.log('🍜 ラーメンドロップダウンスクリプト読み込み完了');
</script>
