<header style="position: fixed; top: 0; left: 0; right: 0; z-index: 1000;">
  <nav class='navbar navbar-expand-lg navbar-light' style="padding: 1rem; background-color: #F5F0E8;">
    <div class="container-fluid">
      <%= link_to root_path, class: 'navbar-brand' do %>
        <span class="fs-3 fw-bold text-danger">ğŸœ <%= t('.title') %></span>
      <% end %>
      
      <div class="d-flex">
        <% if logged_in? %>
          <div class="position-relative">
            <button class="btn btn-outline-primary" 
                    type="button" 
                    id="ramenUserBtn"
                    onclick="toggleRamenMenu()">
              <%= current_user.email if current_user %> â–¼
            </button>
            <div id="ramenUserMenu" 
                 class="dropdown-menu position-absolute" 
                 style="display: none; top: 100%; right: 0; z-index: 1050;">
              <%= link_to t('.profile'), user_path(current_user), class: 'dropdown-item' %>
              <%= link_to t('.search'), maps_path, class: 'dropdown-item' %>
              <%= link_to t('.post'), boards_path, class: 'dropdown-item' %>
              <hr class="dropdown-divider">
              <%= link_to t('.logout'), logout_path, class: 'dropdown-item', data: { turbo_method: :delete } %>
            </div>
          </div>
        <% else %>
          <%= link_to t('.login'), login_path, class: "btn btn-outline-primary me-2" %>
          <%= link_to t('.create'), new_user_path, class: "btn btn-primary" %>
        <% end %>
      </div>
    </div>
  </nav>
</header>

<script>
// ========================================
// ğŸœ ãƒ©ãƒ¼ãƒ¡ãƒ³é“å°‚ç”¨ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³
// ========================================
function toggleRamenMenu() {
  console.log('ğŸœ ãƒ©ãƒ¼ãƒ¡ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ãƒˆã‚°ãƒ«ä¸­...');
  
  const menu = document.getElementById('ramenUserMenu');
  const btn = document.getElementById('ramenUserBtn');
  
  if (!menu || !btn) {
    console.error('âŒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¾ãŸã¯ãƒœã‚¿ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    return;
  }
  
  if (menu.style.display === 'none' || menu.style.display === '') {
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
    menu.style.display = 'block';
    btn.innerHTML = btn.innerHTML.replace('â–¼', 'â–²');
    console.log('âœ… ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã—ã¾ã—ãŸ');
  } else {
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’éè¡¨ç¤º
    menu.style.display = 'none';
    btn.innerHTML = btn.innerHTML.replace('â–²', 'â–¼');
    console.log('âœ… ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’éè¡¨ç¤ºã«ã—ã¾ã—ãŸ');
  }
}

// å¤–éƒ¨ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ã‚‹
document.addEventListener('click', function(event) {
  const menu = document.getElementById('ramenUserMenu');
  const btn = document.getElementById('ramenUserBtn');
  
  if (menu && btn) {
    if (!btn.contains(event.target) && !menu.contains(event.target)) {
      menu.style.display = 'none';
      btn.innerHTML = btn.innerHTML.replace('â–²', 'â–¼');
    }
  }
});

// Turboå¯¾å¿œ
document.addEventListener('turbo:load', function() {
  console.log('ğŸœ ãƒ©ãƒ¼ãƒ¡ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼æº–å‚™å®Œäº†ï¼');
});

console.log('ğŸœ ãƒ©ãƒ¼ãƒ¡ãƒ³ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿å®Œäº†');
</script>
