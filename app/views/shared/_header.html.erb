<header style="position: fixed; top: 0; left: 0; right: 0; z-index: 1000;">
  <nav class='navbar navbar-expand-lg navbar-light' style="padding: 1rem; background-color: #F5F0E8;">
    <div class="container-fluid">
      <%= link_to root_path, class: 'navbar-brand' do %>
        <span class="fs-3 fw-bold text-danger">üçú <%= t('.title') %></span>
      <% end %>
      
      <div class="d-flex">
        <% if logged_in? %>
          <div class="position-relative">
            <button class="btn-ramen-hover d-flex align-items-center gap-2" 
                    type="button" 
                    id="ramenUserBtn"
                    onclick="toggleRamenMenu()">
              „É°„Éã„É•„Éº
              <span class="dropdown-arrow">‚ñº</span>
            </button>
            <div id="ramenUserMenu" 
                 class="dropdown-menu position-absolute" 
                 style="display: none; top: 100%; right: 0; z-index: 1050;">
              <%= link_to t('.profile'), user_path(current_user), class: 'dropdown-item' %>
              <%= link_to t('.post'), reviews_path, class: 'dropdown-item' %>
              <%= link_to t('.location'), search_location_path, class: 'dropdown-item' %>
              <%= link_to t('.shop'), search_shop_path, class: 'dropdown-item' %>
              <%= link_to '„Åì„Å†„Çè„ÇäÊ§úÁ¥¢', search_filter_path, class: 'dropdown-item' %>
              <hr class="dropdown-divider">
              <%= link_to t('.logout'), logout_path, class: 'dropdown-item', data: { turbo_method: :delete } %>
            </div>
          </div>
        <% else %>
          <%= link_to t('.login'), login_path, class: "btn btn-outline-primary me-2" %>
          <%= link_to t('.create'), new_user_path, class: "btn btn-primary" %>
        <% end %>
      </div>
    </div>
  </nav>
</header>

<script>
function toggleRamenMenu() {
  const menu = document.getElementById('ramenUserMenu');
  const btn = document.getElementById('ramenUserBtn');
  const arrow = btn.querySelector('.dropdown-arrow');
  
  if (!menu || !btn) {
    return;
  }
  
  if (menu.style.display === 'none' || menu.style.display === '') {
    menu.style.display = 'block';
    arrow.textContent = '‚ñ≤';
  } else {
    menu.style.display = 'none';
    arrow.textContent = '‚ñº';
  }
}

document.addEventListener('click', function(event) {
  const menu = document.getElementById('ramenUserMenu');
  const btn = document.getElementById('ramenUserBtn');
  const arrow = btn?.querySelector('.dropdown-arrow');
  
  if (menu && btn) {
    if (!btn.contains(event.target) && !menu.contains(event.target)) {
      menu.style.display = 'none';
      if (arrow) arrow.textContent = '‚ñº';
    }
  }
});
</script>