<div class="mypage-container">
  <!-- プロフィールセクション -->
  <%= render 'profile_section', user: @user %>

  <!-- 自分のページの場合のみ編集リンクとタブを表示 -->
  <% if @user == current_user %>
    <!-- タブセクション -->
    <ul class="nav nav-tabs justify-content-center" id="shopTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="posts-tab" data-bs-toggle="tab" 
                data-bs-target="#posts" type="button" role="tab">
          投稿
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="favorites-tab" data-bs-toggle="tab" 
                data-bs-target="#favorites" type="button" role="tab">
          お気に入り
        </button>
      </li>
    </ul>

    <!-- タブコンテンツ -->
    <div class="tab-content" id="shopTabsContent">
      <!-- 投稿タブ -->
      <div class="tab-pane fade show active" id="posts" role="tabpanel">
        <div class="container mt-4">
          <% if @posts.present? %>
            <div class="row">
              <% @posts.each do |post| %>
                <div class="col-md-6 col-lg-4 mb-4">
                  <div class="card h-100">
                    <% if post.board_image.present? %>
                      <%= image_tag post.board_image.url, class: "card-img-top", 
                                    style: "height: 200px; object-fit: cover;" %>
                    <% end %>
                    <div class="card-body">
                      <h5 class="card-title"><%= post.title %></h5>
                      <p class="card-text"><%= truncate(post.body, length: 100) %></p>
                      <div class="mt-auto">
                        <%= link_to "詳細を見る", board_path(post), class: "btn btn-primary btn-sm" %>
                      </div>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          <% else %>
            <div class="text-center mt-5">
              <i class="fas fa-edit fa-4x text-muted mb-3"></i>
              <h5 class="text-muted">まだ投稿がありません</h5>
              <p class="text-muted">最初の投稿をしてみましょう！</p>
              <%= link_to "投稿する", new_board_path, class: "btn btn-primary" %>
            </div>
          <% end %>
        </div>
      </div>

      <!-- お気に入りタブ -->
      <div class="tab-pane fade" id="favorites" role="tabpanel">
        <div class="container mt-4">
          <% if @favorite_shops.present? %>
            <div class="row">
              <% @favorite_shops.each do |shop| %>
                <div class="col-md-6 col-lg-4 mb-4">
                  <%= render 'favorite_shop_card', shop: shop %>
                </div>
              <% end %>
            </div>
          <% else %>
            <div class="text-center mt-5">
              <i class="far fa-heart fa-4x text-muted mb-3"></i>
              <h5 class="text-muted">お気に入りした店舗がありません</h5>
              <p class="text-muted">気になる店舗を見つけてお気に入りに追加してみましょう！</p>
              <%= link_to "店舗を探す", maps_path, class: "btn btn-primary" %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>
